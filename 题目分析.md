# 1\. 术语

### 1.1 点目标量测（point target measurement）

**概念**

-   假设目标相对传感器的**分辨单元（雷达波束、距离门、像素）非常小**，可以看成一个几何点。
    
-   每个目标在每个扫描周期里，**最多产生一个量测点**（当然也可能因为漏检没有量测）。
    
-   经典模型是
    
    $$
    z_k = H x_k + v_k
    $$
    
    其中 $x_k$ 是目标状态（位置、速度等），$z_k$ 是量测（距离/方位或笛卡尔坐标），$v_k$ 是高斯噪声。
    

**在本题里的对应关系**

-   当目标与某雷达的距离 **≥ 50 km** 时，就按点目标处理——每个目标每个雷达给出 **一个带噪声的点量测**（或者没有量测）。
    

---

### 1.2 扩展目标量测（extended target measurement）

**概念**

-   目标的物理尺寸**不可忽略**，在雷达的分辨单元内会占据多个单元，例如舰船、编队、密集车列等。
    
-   结果是：**一次扫描里，单个目标会产生多个散射点量测**，这些量测围绕着目标的真实几何形状散布。
    
-   量测模型不再是“一个向量”，而是“一个集合”：
    
    $$
    Z_k = \{ z_k^{(1)},\dots,z_k^{(m_k)}\}
    $$
    
    其中 $m_k$ 是一个随机数（常建模成泊松分布），每个 $z_k^{(i)}$ 服从中心在目标位置、协方差与目标形状/雷达分辨率有关的分布。
    

**在本题里的对应关系**

-   当目标距某雷达 **< 50 km** 时，该雷达对该目标的回波被认为是**扩展回波**：
    
    -   一帧里会对同一个目标产生一群点（cluster），不能压扁成一个均值点再当点目标用；
        
    -   题目明确要求“必须用扩展目标跟踪理论处理”。
        

---

### 1.3 状态误差标准差（state error standard deviation）

**概念**

-   指对“目标运动状态”估计误差的标准差，包括位置误差、速度误差等。
    
-   在滤波模型里通常体现在：
    
    1.  **初始状态协方差 $P_0$** ——比如“初始位置误差 5 m、速度误差 5 m/s”就是
        
        $$
        P_0 = \mathrm{diag}(5^2, 5^2, 5^2, 5^2)
        $$
        
    2.  或对过程噪声的合理设定，描述系统模型不完美带来的不确定性。
        

**在本题里的意义**

-   给出“状态误差标准差 5 m、5 m/s”，就是告诉你**初始化卡尔曼滤波器的 P 矩阵**或者生成真值时可以加的扰动尺度：
    
    -   你可以假设初始状态与真实状态有大约±5 m、±5 m/s 的偏差。
        

---

### 1.4 量测误差标准差（measurement error standard deviation）

**概念**

-   描述传感器对某个量测维度的噪声大小，比如：
    
    -   位置测量标准差 20 m；
        
    -   速度测量标准差 10 m/s。
    
-   直接决定**量测噪声协方差矩阵 $R$**，例如：
    
    $$
    R = \mathrm{diag}(20^2, 20^2)
    $$
    

**在本题里的意义**

-   用于构造雷达量测：
    
    -   先算“理想量测”（由真实状态通过 H 映射得到），
        
    -   再加上 $\mathcal{N}(0, R)$ 的噪声。
    
-   也用于滤波更新时的 $R$——**R 越大，滤波器越不信任当前雷达量测**。
    

---

### 1.5 遮蔽（occlusion / masking）

**概念**

-   由于地形、建筑物、平台自身结构或其他目标遮挡，导致 **雷达和目标之间的视线被阻挡**，虽然目标在物理上存在，但传感器**无法得到有效量测**。
    
-   在跟踪模型里，表现为：
    
    -   **检测概率 $P_D$** 在某些时刻或区域显著下降（甚至为 0）。
        

**在本题里的意义**

-   题目抽象成“在某区域释放压制干扰，2 号雷达至少 5 秒看不到目标”，可以理解为：
    
    -   在这个区域 + 时间段上，**R2 对目标的 $P_D \approx 0$**；
        
    -   轨迹上会出现“中断”，需要算法靠动态预测和其他雷达维持轨迹。
        

---

### 1.6 杂波（clutter）

**概念**

-   不是目标产生的“假量测”，可能来自：
    
    -   海浪、地杂波、雨雪、鸟群等自然回波；
        
    -   其他不关心的真实物体。
    
-   在统计建模里通常假设：
    
    -   **服从泊松过程**：每一帧杂波点数 $K \sim \mathrm{Poisson}(\lambda)$；
        
    -   杂波位置在监视区域内**均匀分布**或按已知密度分布。
    
-   在多目标跟踪理论中，杂波和目标量测一起构成观测集合，**是数据关联和 RFS 建模的核心噪声源**。书里在介绍 PHD、CPHD、多假设跟踪时都把杂波建模为泊松过程。目标跟踪前沿理论与应用\_13693769
    

**在本题里**

-   指定“杂波强度不低于 5 个/km²”，就是在告诉你：
    
    -   对每个雷达、每帧，需要在某个区域按强度 λ ≥ 5/km² 生成一定数量的**假点**；
        
    -   这些假点会和真实目标点混在一起，考验数据关联和 RFS 滤波。
        

---

### 1.7 压制干扰（jamming）

**概念**

-   一种**有意的电子对抗手段**：干扰机向雷达频段发射强噪声或欺骗信号，降低雷达对真实目标的信噪比，使其“看不见”或“看错”。
    
-   在跟踪建模中常被简化为：
    
    -   某区域/时间段内，**探测概率 $P_D$ 急剧降低**；
        
    -   或者**杂波强度 λ 增大很多**（假目标爆发）。
        

**在本题里**

-   “目标在某区域释放压制干扰，2 号雷达至少 5 秒内无法观测目标”：
    
    -   本质上就是对 R2 设置一段时间的“**严重漏检**”；
        
    -   算法需要具有**跨遮蔽/干扰保持轨迹连续**的能力。
        

---

# 2\. 本题分析

## 选型总说明：为什么最后选了多 Bernoulli（GLMB）

本题的场景特点很鲜明：

-   **目标数量少而明确**：主要关注 2 个目标 A、B 的交汇和机动；
    
-   **需要“轨迹级”结论**：要看在交汇、遮蔽和压制干扰存在时，算法能否保持每一条轨迹的**连续性与身份（ID）**；
    
-   **存在扩展量测**：近距离时单目标一次扫描产生多点量测，必须显式建模目标的几何扩展和量测率；
    
-   **存在杂波、漏检和多传感器**：多部雷达、杂波强、局部时间段 Pd≈0。
    

在随机有限集（RFS）框架下，常用的三类滤波器——PHD、CPHD 和多 Bernoulli（MB/LMB/GLMB/PMBM）——都可以处理“未知目标数 + 杂波 + 漏检”的多目标问题，但侧重点不同：

-   **PHD / CPHD** ：主要给出“哪里有目标、期望有几个”，对具体每一条轨迹和 ID 不敏感，需要额外做轨迹提取。
    
-   **多 Bernoulli（尤其是带标签的 LMB/GLMB）** 天然以“目标”为基本单元，为每个目标维护存在概率和完整轨迹，更适合需要分析**交汇场景中的 ID-switch、遮蔽期间的轨迹保持**等指标。
    

因此，在系统对比后，本设计选择：

> **采用扩展目标的标签化多 Bernoulli 滤波框架（如 GLMB）作为核心算法**，  
> 并将 PHD / CPHD 作为理论对比对象，用于说明多 Bernoulli 的优势和适用性。

下面的 2.1–2.4 就围绕这个选型展开。

---

## 2.1 问题分析（RFS 视角下的任务建模）

1.  **场景与状态空间**
    

-   平面 2D 场景中，布设 3 部雷达，位置已知。
    
-   目标 A、B 运动于该平面：
    
    -   A：全程存在，匀速直线为主；
        
    -   B：中途进入，与 A 在 F 点交汇后机动（改变航向/速度）。
    
-   为了同时描述运动和形状，引入**扩展目标状态**：
    
    $$
    \xi = (x, X, \gamma)
    $$
    -   $x$：运动状态，如 $x=[p_x, p_y, v_x, v_y]^T$；
        
    -   $X$：2×2 对称正定矩阵，描述目标在雷达视角下的几何扩展（椭圆）；
        
    -   $\gamma$：单位时间内期望量测点数（量测率）。
        

2.  **量测类型：点目标 + 扩展目标混合**
    

-   当目标距某雷达 **≥50 km** 时：
    
    -   目标尺寸相对雷达分辨单元可忽略，认为是**点目标量测**；
        
    -   每帧、每部雷达对同一目标**最多给出 0 或 1 个量测**。
    
-   当目标距某雷达 **<50 km** 时：
    
    -   目标在雷达分辨单元中跨越多个单元，产生**扩展目标量测**；
        
    -   一次扫描中，同一目标产生 **$m_k$ 个量测点**，$m_k$ 服从泊松分布，点云分布与 $X$ 和 R 有关。
        

3.  **环境不完美性**

-   **杂波**：各雷达监视区域内存在泊松杂波，强度不低于 5 个/km²；
    
-   **漏检与遮蔽/压制干扰**：
    
    -   一般情况下，各雷达的检测概率 $P_D \in (0,1)$；
        
    -   在某区域、某时间段内，目标释放压制干扰，使 2 号雷达的 $P_D \approx 0$，至少持续 5s；
    
-   **测量与状态噪声**
    
    -   量测误差标准差：位置 20 m，速度 10 m/s；
        
    -   状态误差标准差：位置 5 m，速度 5 m/s，用于初始不确定度和过程噪声设定。
        

4.  **多目标 RFS 建模**
    

整个时刻 k 的**多目标状态**被建模为一个随机有限集：

$$
\mathbf{X}_k = \{ \xi_k^{(1)}, \dots, \xi_k^{(N_k)} \}
$$

其中目标数 $N_k$ 随时间变化；同样，量测集合 $\mathbf{Z}_k$ 也是一个随机有限集，由目标回波和杂波混合而成。

**任务目标：**

-   在 RFS 框架下，设计能够处理“**扩展量测 + 多目标 + 多雷达 + 杂波 + 漏检**”的滤波算法；
    
-   输出每个目标的**时间序列轨迹（含 ID）和扩展形状**，并对在交汇与遮蔽干扰场景中的表现进行定量评估。
    

---

## 2.2 常见 RFS 算法家族及比较（PHD / CPHD / 多 Bernoulli）

### 2.2.1 PHD 滤波（Probability Hypothesis Density）

-   估计的是多目标概率密度的**一阶矩** $v(x)$，可理解为“单位状态空间内目标的期望数”；
    
-   优点：
    
    -   计算量相对较低，适合目标数量大、仅关心“目标云”和总体数量的场景；
        
    -   可以扩展为扩展目标版本（如 GGIW-PHD），处理扩展形状和量测率。
    
-   局限：
    
    -   不直接给出明确的目标数分布，只是一个“期望数量”；目标数波动较明显；
        
    -   不携带轨迹标签，需要做额外 track extraction，**轨迹连续性和 ID-switch 难以精确刻画**。
        

### 2.2.2 CPHD 滤波（Cardinalized PHD）

-   在 PHD 的基础上，再估计多目标状态的**基数分布**（cardinality），即不同目标数出现的概率；
    
-   优点：
    
    -   在检测概率较低、杂波强的环境下，目标数估计更稳定；
        
    -   扩展目标版本（GGIW-CPHD）同样存在。
    
-   局限：
    
    -   计算复杂度高于 PHD；
        
    -   与 PHD 一样，主要是集合级统计量，轨迹与 ID 仍需额外算法维护，不够“轨迹友好”。
        

### 2.2.3 多 Bernoulli 类滤波（MB / LMB / GLMB / PMBM）

-   将多目标状态建模为多个 Bernoulli 组件的集合：
    
    -   每个组件表示“一个可能存在的目标”，具备**存在概率**和**单目标状态分布**；
    
-   若进一步为每个组件赋予唯一标签（label），就得到 **标签化多 Bernoulli（LMB / GLMB）**：
    
    -   每一条轨迹从出生起就携带标签，后续更新与管理都在标签层面进行；
        
    -   自然提供“**轨迹级输出与 ID 管理**”。
    
-   扩展目标版本：
    
    -   通过将单目标状态拓展为 $(x, X, \gamma)$，并选用 GGIW（Gamma–Gaussian–Inverse–Wishart）族进行参数化，可构造 **GGIW-LMB / GGIW-GLMB / PMBM-ET** 等扩展目标滤波器；
        
    -   每个 Bernoulli 组件同时估计位置、速度、形状与量测率。
    
-   优点：
    
    -   天然输出**带 ID 的轨迹集合**，非常适合评估：轨迹连续性、ID 交换、遮蔽期间的跟踪保持等；
        
    -   容易集成多传感器、多模型（如 CV/CA/CT）等扩展；
        
    -   对目标数量中小、对轨迹级结果要求高的场景特别合适。
    
-   局限：
    
    -   实现复杂度高于 PHD/CPHD，需要假设管理、剪枝和合并等工程细节；
        
    -   目标数量极大时，计算量会成为瓶颈，但在本题“少目标”场景下完全可接受。
        

**比较结论：**

-   PHD / CPHD 更像“**统计级人群估计器**”，适合看“目标云”和“数量”，不擅长精细轨迹分析；
    
-   多 Bernoulli（尤其是带标签的 GGIW-LMB/GLMB）则是“**轨迹级多目标跟踪器**”，能直接给出每条轨迹的时间序列与 ID；
    
-   鉴于本题强调“交汇、遮蔽与干扰条件下的轨迹跟踪性能评估”，**多 Bernoulli 系列是更契合需求的选择**。
    

---

## 2.3 整体方案：基于 GGIW-LMB 的扩展目标多雷达跟踪框架

在上述分析基础上，本设计采用**扩展目标标签化多 Bernoulli（GGIW-LMB）滤波器**作为总体方案，核心思想如下：

1.  **单目标扩展状态建模**
    

-   对每个目标 $i$：
    
    $$
    \xi^i_k = (x^i_k, X^i_k, \gamma^i_k)
    $$
    -   运动状态 $x^i_k$：匀速/匀加速模型（CV/CA），描述位置和速度；
        
    -   扩展矩阵 $X^i_k$：二维正定矩阵，描述在雷达平面下的椭圆形几何范围；
        
    -   量测率 $\gamma^i_k$：单位扫描内期望量测点数。
    
-   概率建模：
    
    -   $x^i_k | X^i_k \sim \mathcal{N}(\cdot)$；
        
    -   $X^i_k \sim \mathcal{IW}(\cdot)$（逆 Wishart）；
        
    -   $\gamma^i_k \sim \Gamma(\cdot)$（Gamma 分布）。
        

2.  **多目标 LMB 表示**
    

-   整体多目标状态建模为一组带标签的 Bernoulli 组件集合：
    
    $$
    \mathbf{X}_k = \{ (L_j, r_k^{(j)}, f_k^{(j)}(\xi)) \}_{j}
    $$
    -   $L_j$：第 j 个目标的唯一标签（对应 A、B 及其可能的分裂/重生）；
        
    -   $r_k^{(j)}$：存在概率；
        
    -   $f_k^{(j)}(\xi)$：对应的 GGIW 单目标状态分布。
    
-   LMB 假设使得整个多目标 RFS 的后验可以用一组相互独立的 Bernoulli 分量近似，从而实现高效的预测和更新。
    

3.  **量测模型：点/扩展统一处理**
    

-   对于某部雷达 r，在时刻 k，对某目标 $i$ 的量测集合：
    
    $$
    Z_{k,r}^i = \{ z_{k,r}^{i,1}, \dots, z_{k,r}^{i,m_{k,r}^i} \}
    $$
    -   若目标距离该雷达 ≥50 km，则 $m_{k,r}^i$ 退化为 0 或 1（点目标情形）；
        
    -   若距离 <50 km，则 $m_{k,r}^i \sim \mathrm{Poisson}(\gamma_{k,r}^i)$，每个量测
        
        $$
        z \sim \mathcal{N}\left(H_r x^i_k,\; X^i_k + R_r\right)
        $$
    
-   各雷达的杂波单独建模为泊松 RFS，具有各自的杂波强度和监视区域。
    

4.  **多雷达与干扰建模**
    

-   **多雷达融合**：
    
    -   在每一时刻，将三部雷达的量测集合统一视作一个 RFS，量测似然中区分不同雷达的 Pd、R、杂波强度；
    
-   **遮蔽与压制干扰**：
    
    -   对 2 号雷达，在干扰区域 + 时间段内设置 $P_D^{(R2)} \approx 0$；
        
    -   LMB 更新公式中自然体现“无量测但存在概率衰减”的行为；
        
    -   通过其他雷达的量测仍可维持轨迹。
        

5.  **目标机动与交汇**
    

-   对目标 B 的机动，可采用：
    
    -   IMM（多模型）扩展：为 GGIW-LMB 引入多个运动模型（CV/CA/CT），在标签级别做模型混合；
        
    -   或在机动时段增大过程噪声 Q，允许状态有更大跳变；
    
-   在 A、B 交汇区域，LMB 的标签机制有助于减少 ID 交换（ID-switch），对于突发的量测混淆，结合数据关联权重和轨迹先验实现鲁棒分配。
    

---

## 2.4 算法与验证方案（含评估指标）

### 2.4.1 算法流程设计

为了验证 GGIW-LMB 在本场景下的有效性，整体流程可设计为：

1.  **仿真数据生成**
    
    -   根据题目设定构造仿真场景：
        
        -   三部雷达位置、探测范围；
            
        -   目标 A、B 的真值轨迹（含交汇与机动）；
            
        -   点/扩展量测切换阈值（50 km）；
            
        -   杂波强度 ≥ 5 个/km²；
            
        -   2 号雷达遮蔽/压制干扰区域与时间段（Pd≈0）。
        
    -   输出：每一时刻的真值多目标状态集 $\mathbf{X}_k^\text{true}$ 和多雷达量测集合 $\{\mathbf{Z}_{k,r}\}$。
    
2.  **GGIW-LMB 滤波**
    -   **初始化**：
        
        -   根据先验位置/速度范围、状态误差标准差 (5 m, 5 m/s)，初始化少量 Bernoulli 分量（对应 A、B 的初始存在假设）；或者采用“量测驱动的出生模型”。
        
    -   **预测步**：
        
        -   对每个 Bernoulli 分量：
            
            -   运动状态 $x$ 按 CV/CA 模型预测；
                
            -   扩展矩阵 $X$ 按随机矩阵模型缓变；
                
            -   量测率 $\gamma$ 按 Gamma 先验延拓；
                
            -   存在概率 $r$ 按生存概率更新。
        
    -   **更新步**：
        
        -   对每个传感器的量测集合 $\mathbf{Z}_{k,r}$，结合检测概率、杂波强度，构造多目标似然；
            
        -   在 LMB 框架下，对每个标签的 GGIW 分布进行闭式更新（位置、扩展和量测率三者联合更新）；
            
        -   对“点目标量测”可以看做是 $m_k=1$ 的退化扩展量测。
        
    -   **重标定与剪枝**：
        
        -   对低存在概率的 Bernoulli 分量进行删除；
            
        -   合并相似的分量控制计算量；
            
        -   保持标签唯一性和轨迹连续性。
    
3.  **轨迹提取与后处理**
    
    -   对存在概率高于阈值的 Bernoulli 组件视为“当前有效目标”；
        
    -   拼接不同时间的状态估计，得到 A、B 的估计轨迹；
        
    -   同时保留扩展矩阵估计序列，用于形状误差评价。
    
4.  **与基线算法对比（可选）**
    
    -   选取简化的 GGIW-PHD 或“点目标 JPDA + 聚类”作为对比基线：
        
        -   说明在交汇与遮蔽场景下，PHD / JPDA 在目标数稳定性、ID 连续性方面的不足；
            
        -   突出 LMB 的轨迹级优势。
            

---

### 2.4.2 评估指标体系

评估指标分为**单目标/形状层面**和**多目标/轨迹整体层面**。

#### （1）单目标与形状估计指标

1.  **位置/速度 RMSE**
    
    -   在真实存在的时刻，对每个目标分别计算位置与速度的均方根误差：
        
        $$
        \text{RMSE}_{\text{pos}}^i = \sqrt{\frac{1}{T_i}\sum_k \| \hat{p}_k^i - p_k^{i,\text{true}} \|^2}
        $$
        
        同理定义 $\text{RMSE}_{\text{vel}}^i$。
    
2.  **扩展形状误差**
    
    -   若真实扩展矩阵为 $X_k^{i,\text{true}}$，估计值为 $\hat{X}_k^i$，可用：
        
        -   Frobenius 范数误差：
            
            $$
            e_{\text{shape},k}^i = \| \hat{X}_k^i - X_k^{i,\text{true}} \|_F
            $$
            
        -   或把椭圆区域转成几何区域，计算**交并比 IoU**：
            
            $$
            \text{IoU}_k^i = \frac{\text{Area}(\hat{E}_k^i \cap E_k^{i,\text{true}})}{\text{Area}(\hat{E}_k^i \cup E_k^{i,\text{true}})}
            $$
    
3.  **遮蔽/干扰期间的轨迹保持率**
    
    -   在 2 号雷达 Pd≈0 时段，统计 A、B 轨迹是否仍然被正确维持：
        
        -   定义在给定误差门限内的“**有效跟踪时间比例**”作为指标。
            

#### （2）多目标与轨迹级指标

1.  **OSPA 
    -   在每一时刻，将真实目标集合和估计目标集合的差异用 OSPA 或 GOSPA 度量，综合反映：
        
        -   位置误差；
            
        -   漏检（miss）；
            
        -   虚警（false target）；
        
    -   对时间求平均后得到整体多目标跟踪性能指标。
    
2.  **ID-switch 数量与轨迹完整性**   XXXXXXX 
    -   在 A、B 交汇附近，统计是否出现 ID 交换：
        
        -   **ID-switch count**：真实目标与估计轨迹的匹配关系发生改变的次数；
        
    -   **轨迹碎片化程度**：一条真实轨迹被分割成多少段估计轨迹；
        
    -   **track continuity**：估计轨迹覆盖同一真实目标的时间比例。
    
3.  **检测与虚警相关指标 ** 
    -   **跟踪概率 $P_\text{track}$**：
        
        -   在给定误差门限条件下，真实目标被成功跟踪的扫描比例；
        
    -   **虚警轨迹率**：
        
        -   完全由杂波形成的“假轨迹”数量 或比例；
        
    -   在不同杂波强度、不同干扰持续时间下绘制性能曲线。
        

---

### 2.4.3 验证策略小结

-   通过仿真实验，在控制变量（杂波强度、干扰时长、雷达配置）下，对比：
    
    -   GGIW-LMB 的各项指标（RMSE、OSPA/GOSPA、ID-switch、轨迹保持率）；
        
    -   与 PHD/CPHD 或点目标基线的差异；
    
-   验证 GGIW-LMB 在“**扩展目标 + 杂波 + 遮蔽/干扰 + 交汇机动**”综合场景下，能够：
    
    1.  **稳定地估计目标数与轨迹**；
        
    2.  **保持较低的位置/速度误差**；
        
    3.  **显著降低 ID-switch 和假轨迹产生**。